schemaVersion: 1
techId: EchoB

description: >
  Echo is the harness/reference tech used to validate the full Core execution pipeline:
  multi-collector orchestration, dataset/coverage writing, objectIndex writing,
  schema validation, and per-collector failure isolation.

appliesTo:
  targetKind: echo

unknownFieldPolicy:
  plan: warn
  target: warn
  collector: warn

defaults:
  target:
    endpoints: {}
    params: {}
    tags: {}
  collector:
    params: {}

validation:
  required:
    - schemaVersion
    - solutionId
    - targets
    - collectors

  targets:
    minItems: 1
    each:
      required:
        - key
        - kind
        - displayName
        - endpoints
        - params
        - tags
      forbid:
        - techId
      types:
        key: string
        kind: string
        displayName: string
        endpoints: object
        params: object
        tags: object

  collectors:
    minItems: 1
    each:
      required:
        - techId
        - module
        - entryPoint
      types:
        techId: string
        module: string
        entryPoint: string
        targetKeys: array
        params: object

      constraints:
        - path: techId
          equals: "EchoB"

      semantic:
        targetKeysMustExistInTargets: true

      allowParams:
        - forceFail
